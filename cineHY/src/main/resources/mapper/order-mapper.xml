<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hy.myapp.order.model.repository.OrderRepository">

	<insert id="saveOrder" parameterType="order">
		INSERT
  		   INTO
        			TB_ORDER
       				 (
			        MERCHANT_UID,
			        CART_NO,
			        USER_ID,
			        USER_NAME,
			        PRODUCT_ID,
			        PRODUCT_NAME,
			        PRODUCT_COMMENT,
			        CHANGE_IMAGE,
			        PAY_METHOD,
			        AMOUNT,
			        MOVIE_CODE,
			        MOVIE_TITLE,
			        PRICE,
			        PHONE_NO,
			        ORDER_DAY
			        )
		VALUES
        			(
        			#{merchantUid},
			        #{cartNo},
			        #{userId},
			        #{userName},
			        #{productId},
			        #{productName},
			        #{productComment},
			        #{changeImage},
			        #{payMethod},
			        #{amount},
			        #{movieCode},
			        #{movieTitle},
			        #{price},
			        #{phoneNo},
			        SYSDATE
			        )
			        
	</insert>
	
	<delete id="deleteCart" parameterType="order">
		DELETE
		   FROM 
        			TB_CART
		 WHERE
        			CART_NO = #{cartNo}
			 AND
        			USER_ID = #{userId}
	</delete>
	
	<select id="findById" resultType="order">
		SELECT
					MERCHANT_UID merchantUid,
					PRODUCT_NAME productName,
					PRODUCT_COMMENT productComment,
					CHANGE_IMAGE changeImage,
					AMOUNT * PRICE amount,
					PAY_METHOD payMethod
		  FROM
		  			TB_ORDER
		WHERE
					MERCHANT_UID = #{merchantUid}
	</select>
	
</mapper>